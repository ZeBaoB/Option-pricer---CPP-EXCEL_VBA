Sub update_OptionPriceGraph(ByRef underlying() As Double, ByRef option_price() As Double, ByVal numberOfpoint As Integer)
    Dim STabStr As String
    Dim PTabStr As String
    
    STabStr = "{" & Str(Round(underlying(1), 3))
    PTabStr = "{" & Str(Round(option_price(1), 3))
    
    Dim i As Integer
    For i = 2 To numberOfpoint - 1
        STabStr = STabStr + "," + Str(Round(underlying(i), 3))
        PTabStr = PTabStr + "," + Str(Round(option_price(i), 3))
    Next i
    
    STabStr = STabStr & "}"
    PTabStr = PTabStr & "}"
    
    
    ActiveSheet.ChartObjects("Option Price").Activate
    ActiveChart.FullSeriesCollection(1).XValues = STabStr
    ActiveChart.FullSeriesCollection(1).Values = PTabStr
    ActiveChart.Axes(xlCategory).MinimumScale = 0
    ActiveChart.Axes(xlCategory).MaximumScale = underlying(numberOfpoint)
    
    
End Sub

Sub update_DeltaGraph(ByRef underlying() As Double, ByRef delta() As Double, ByVal numberOfpoint As Integer)
    Dim STabStr As String
    Dim PTabStr As String
    
    STabStr = "{" & Str(Round(underlying(3), 3))
    PTabStr = "{" & Str(Round(delta(3), 3))
    
    Dim i As Integer
    For i = 4 To numberOfpoint - 1
        STabStr = STabStr + "," + Str(Round(underlying(i), 3))
        PTabStr = PTabStr + "," + Str(Round(delta(i), 3))
    Next i
    
    STabStr = STabStr & "}"
    PTabStr = PTabStr & "}"
    
    ActiveSheet.ChartObjects("Delta").Activate
    ActiveChart.FullSeriesCollection(1).XValues = STabStr
    ActiveChart.FullSeriesCollection(1).Values = PTabStr
    ActiveChart.Axes(xlCategory).MinimumScale = 0
    ActiveChart.Axes(xlCategory).MaximumScale = underlying(numberOfpoint)
    
    
End Sub


Sub update_BoundaryGraph(ByRef boundary() As Double, ByVal numberOfpoints As Integer, T As Double, T0 As Long)
    Dim STabStr As String
    Dim PTabStr As String
    
    'MsgBox T0
    STabStr = "{" + Str(T0)
    PTabStr = "{" & Str(Round(boundary(1), 3))
    
    Dim i As Integer
    For i = 2 To numberOfpoints
        STabStr = STabStr + "," + Str(T0 + 365 * T * (i - 1) / numberOfpoints)
        PTabStr = PTabStr + "," + Str(Round(boundary(i), 3))
    Next i
    
    STabStr = STabStr & "}"
    PTabStr = PTabStr & "}"
    'MsgBox PTabStr
    
    ActiveSheet.ChartObjects("Exercice boundary").Activate
    'MsgBox STabStr
    ActiveChart.FullSeriesCollection(1).XValues = STabStr
    ActiveChart.FullSeriesCollection(1).Values = PTabStr
    ActiveChart.Axes(xlCategory).MinimumScale = T0
    ActiveChart.Axes(xlCategory).MaximumScale = T0 + 365 * T
    
    
End Sub
